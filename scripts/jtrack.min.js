/*! jtrack 2014-11-03 */
var jtrackOp=[],ga;!function($){function _def(a){return"undefined"!=typeof a}function _eval(ele,obj){if("function"==typeof obj)obj=obj(ele);else try{obj=eval("("+obj+"(ele));")}catch(err){}return obj!==!1?obj:void 0}function _d(a){return _def(window.console)&&_def(window.console.debug)&&window.console.debug(a)}function dump(a,b,c){var d,e,f,g,h;for(d="",b||(b=3),c||(c=0),e="",f=0;c+1>f;f++)e+="	";if("object"==typeof a){if(b>=c)for(g in a)h=a[g],"object"==typeof h?(d+=e+"'"+g+"' ...\n",d+=dump(h,b,c+1)):d+=e+"'"+g+"' => \""+h+'"\n'}else d="===>"+a+"<===("+typeof a+")";return d}$.jtrack=function(a){var b,c,d={};$.isPlainObject(a)?(b=$.extend({},{debug:!1,clearCampaignUrls:!0,domainName:window.location.host},a),c=b.domainName,_def(b.analytics)?($.jtrack.defaultsettings=$.extend({},$.jtrack.defaultsettings,b.analytics.defaults),$.jtrack.accounts=b.analytics.accounts,$.fn.trackPage(function(a,b){"undefined"!==a&&($.isPlainObject(a)?$.each(a,function(a,d){_d("appling: "+d.element+" for scope "+b);var e=d.element.replace("**SELF_DOMAIN**",c);$(e).jtrack(_def(d.options)?d.options:null,b)}):$.ajax({dataType:"jsonp",url:a,success:function(a){$.each(a,function(a,d){_d("appling: "+d.element+" for scope "+b);var e=d.element.replace("**SELF_DOMAIN**",c);$(e).jtrack(_def(d.options)?d.options:null,b)})}}))})):_def(b.events)&&$.each(b.events,function(a,b){var d=b.element.replace("**SELF_DOMAIN**",c);$(d).jtrack(_def(b.options)?b.options:null)}),b.clearCampaignUrls&&$.jtrack.clearCampaignUrl()):(d=jtrackOp[a],d.ele.triggerHandler(d.tasactedEvent))},$.jtrack.defaults={debug:!1},$.jtrack.eventdefaults={mode:"event",category:function(a){return a[0].hostname===location.hostname?"internal":"external"},action:function(a){return"undefined"!=typeof a.attr("alt")?a.attr("alt"):""},label:function(a){return"undefined"!=typeof a.text()?a.attr("href"):""},value:function(a){return"undefined"!=typeof a.text()?a.text():""},eventTracked:"click",skip_internal:!1,overwrites:!0,alias:null,nonInteraction:null,callback:function(){}},$.jtrack.accounts={},$.jtrack.settings={},$.jtrack.defaultsettings={namedSpace:!1,cookieName:!1,cookieDomain:window.location.host,cookieExpires:!1,cookiePath:"/",autoLink:!0,autoLinkDomains:[],dimension:[],metrics:[],location:null,hostname:null,experimentID:null,expVar:null,sampleRate:!1,displayfeatures:!1,ecommerce:!1,linkid:!0,events:!1,force_campaign:!1},$.jtrack.init_analytics=function(a){_d("Google Analytics loaded"),$.each($.jtrack.accounts,function(b,c){var d,e,f,g,h,i,j,k;$.jtrack.settings=$.extend({},$.jtrack.defaultsettings,c.settings),d=$.jtrack.settings,e=d.namedSpace?{name:d.namedSpace}:{},f=$.isPlainObject(e)?e.name+".":"",g=d.cookiePath?{cookiePath:d.cookiePath}:{},h=d.cookieDomain?{cookieDomain:d.cookieDomain}:{},i=d.autoLink?{allowLinker:!0}:{},j=d.sampleRate?{sampleRate:d.sampleRate}:{},k=$.extend({},e,h,g,i,j),ga("create",c.id,k==={}?"auto":k),null!==d.location&&ga(f+"set","location",d.location),null!==d.hostname&&ga(f+"set","hostname",d.hostname),null!==d.experimentID&&(ga(f+"set","expId",d.experimentID),ga(f+"set","expVar",d.expVar)),d.dimension.length>0&&$.each(d.dimension,function(a,b){ga(f+"set",b.name,b.val)}),d.metrics.length>0&&$.each(d.metrics,function(a,b){ga(f+"set",b.name,b.val)}),i!=={}&&(ga(f+"require","linker"),d.autoLinkDomains.length>0&&ga(f+"linker:autoLink",d.autoLinkDomains)),d.linkid&&ga(f+"require","linkid","linkid.js"),d.displayfeatures&&ga(f+"require","displayfeatures"),d.force_campaign!==!1&&$.isPlainObject(d.force_campaign)&&(d.force_campaign.campaignName&&ga("set","campaignName",d.force_campaign.campaignName),d.force_campaign.campaignSource&&ga("set","campaignSource",d.force_campaign.campaignSource),d.force_campaign.campaignMedium&&ga("set","campaignMedium",d.force_campaign.campaignMedium),d.force_campaign.campaignKeyword&&ga("set","campaignKeyword",d.force_campaign.campaignKeyword),d.force_campaign.campaignContent&&ga("set","campaignContent",d.force_campaign.campaignContent)),ga(f+"send","pageview"),d.ecommerce&&ga(f+"require","ecommerce"),$.isFunction(a)&&d.events!==!1&&ga(function(){a(d.events,f)})})},$.jtrack.load_script=function(a){!function(b,c,d,e,f,g,h){b.GoogleAnalyticsObject=f,b[f]=b[f]||function(){(b[f].q=b[f].q||[]).push(arguments)},b[f].l=1*new Date,g=c.createElement(d),h=c.getElementsByTagName(d)[0],g.async=1,g.src=e,h.parentNode.insertBefore(g,h),$.jtrack.init_analytics(a)}(window,document,"script","//www.google-analytics.com/analytics.js","ga")},$.fn.trackPage=function(a){"undefined"!=typeof ga&&ga.length>0?_d("!!!!!! Google Analytics loaded previously !!!!!!!"):$.jtrack.settings.onload===!0||null===$.jtrack.settings.onload?$(document).ready(function(){$.jtrack.load_script(a)}):$.jtrack.load_script(a)},$.jtrack.trackEvent=function(a,b,c,d,e,f,g){if(_def(ga)){var h,i,j,k;h=null!==c?{eventCategory:c}:{},i=null!==d?{eventAction:d}:{},j=null!==e?{eventLabel:e}:{},k=null!==f?{eventValue:f}:{},ga(b+"send","event",$.extend({},h,i,j,k)),"undefined"!=typeof g&&($.isFunction(g)?g(a):_eval(a,g)),_d("Fired "+b+"send for Tracking")}else _d("FATAL: ga is not defined")},$.jtrack.trackSocial=function(a,b,c,d,e){if(_def(ga)){var f,g,h;f=null!==c?{socialNetwork:c}:{},g=null!==d?{socialAction:d}:{},h=null!==e?{socialTarget:e}:{},ga(b+"send","social",$.extend({},f,g,h)),_d("Fired "+b+"send for Social Tracking")}else _d("FATAL: ga is not defined")},$.jtrack.trackPageview=function(a,b){_def(a)?(a._trackPageview(b),_d("Fired event for _trackPageview for "+b)):_d("FATAL: pageTracker is not defined")},$.jtrack.hit=function(a,b,c,d){if(_def(ga)){var e,f;e=null!==c?{hitType:c}:{},f=null!==d?{page:d}:{},ga(b+"send",$.extend({},e,f)),_d("Fired "+b+"send for hitType Tracking")}else _d("FATAL: ga is not defined")},$.jtrack.clearCampaignUrl=function(){var a=window.location.href;if(a.indexOf("utm_source=")>-1||a.indexOf("_ga=")>-1){var b=a.split(window.location.host)[1];b=a.split("?")[0],window.history.pushState(null,$(document).find("title").text(),b)}},$.fn.jtrack=function(a,b){return $.each($(this),function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;return c=$(this),d=$.extend({},$.jtrack.eventdefaults,a),e=_eval(c,d.overwrites),e="undefined"===e?"true":e,c.is(".tracked")&&"false"===e?!1:(c.addClass("tracked"),f=d.mode,g=_eval(c,d.alias),h=_eval(c,d.category),i=_eval(c,d.action),j=_eval(c,d.eventTracked),i=""===i?j:i,k=_eval(c,d.label),l=_eval(c,d.value),l=isNaN(l)?1:l,m=_eval(c,d.skip_internal),n=d._link,o=d.nonInteraction,p=d.callback,c.attr("role",j+"_"+i+"_"+h),q=j+"."+("undefined"===g||null===g?"jtrack":g),r=m&&c[0].hostname===location.hostname,_d(r?"Skipping ":"Tracking "),s="undefined"===g||null===g?j:g,jtrackOp[s]=[],jtrackOp[s].ele=c,jtrackOp[s].tasactedEvent=q,"true"===e&&(c.off(q),c.unbind(q),_d("overwriting "+q)),_d("setting event "+q),c.on(q,function(a){if(null!==o&&ga("set","nonInteraction",o),_d("doing event "+q),!r&&f.indexOf("event")>-1&&$.jtrack.trackEvent(c,b,h,i,k,l,p),f.indexOf("_social")>-1&&(t=_eval(c,d.network),u=_eval(c,d.socialAction),$.jtrack.trackSocial(c,b,t,u)),f.indexOf("_link")>-1){_d("Fired _link for Tracking for _link");var e=a.target||a.srcElement;e&&e.href&&ga(b+"linker:decorate",e)}return!0}),void 0)})}}(jQuery);