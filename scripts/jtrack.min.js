/*! jtrack 2014-10-08 */
var pageTracker=null,_gaq=_gaq||[],jtrackedOptions=[];!function(jQuery){function defined(a){return"undefined"!=typeof a}function evaluate(ele,obj){if("function"==typeof obj)obj=obj(ele);else try{obj=eval("("+obj+"(ele));")}catch(err){}return obj!==!1?obj:void 0}function debug(a){return defined(jQuery.jtrack)&&jQuery.jtrack.defaults.debug&&defined(window.console)&&defined(window.console.debug)&&window.console.debug(a)}function dump(a,b,c){var d,e,f,g,h;for(d="",b||(b=3),c||(c=0),e="",f=0;c+1>f;f++)e+="	";if("object"==typeof a){if(b>=c)for(g in a)h=a[g],"object"==typeof h?(d+=e+"'"+g+"' ...\n",d+=dump(h,b,c+1)):d+=e+"'"+g+"' => \""+h+'"\n'}else d="===>"+a+"<===("+typeof a+")";return d}jQuery.jtrack=function(a){var b={};if(jQuery.isPlainObject(a)){var c=jQuery.extend({},{},a),d="undefined"!=typeof c.domainName&&""!==c.domainName?c.domainName:window.location.host;defined(c.load_analytics)?jQuery.fn.trackPage(c.load_analytics.account,defined(c.load_analytics.options)?c.load_analytics.options:null,function(){defined(c.trackevents)&&jQuery.each(c.trackevents,function(a,b){var c=b.element.replace("**SELF_DOMAIN**",d);jQuery(c).jtrack(defined(b.options)?b.options:null)})}):defined(c.trackevents)&&jQuery.each(c.trackevents,function(a,b){var c=b.element.replace("**SELF_DOMAIN**",d);jQuery(c).jtrack(defined(b.options)?b.options:null)}),jQuery.jtrack.clearCampaignUrl(),c.clearCampaignUrls}else b=jtrackedOptions[a],b.ele.triggerHandler(b.tasactedEvent)},jQuery.jtrack.defaults={mode:"event",category:function(a){return a[0].hostname===location.hostname?"internal":"external"},action:function(a){return"undefined"!=typeof a.attr("alt")?a.attr("alt"):""},label:function(a){return"undefined"!=typeof a.text()?a.attr("href"):""},value:function(a){return"undefined"!=typeof a.text()?a.text():""},eventTracked:"click",noninteraction:!1,skip_internal:!1,overwrites:!0,skip_campaign:!1,alias:null,callback:function(){},debug:!1},jQuery.jtrack.settings={},jQuery.jtrack.init_analytics=function(a,b){debug("Google Analytics loaded");var c="//www.google-analytics.com/plugins/ga/inpage_linkid.js";_gaq.push(["_require","inpage_linkid",c]),_gaq.push(["_setAccount",a]),_gaq.push(["_setAllowLinker",!0]),_gaq.push(["_setDomainName","undefined"!=typeof jQuery.jtrack.settings.domainName?jQuery.jtrack.settings.domain:window.location.host]),pageTracker=_gat._createTracker(a),"undefined"!=typeof jQuery.jtrack.settings.domainName&&("undefined"==typeof jQuery.jtrack.settings._addIgnoredRef||"undefined"!=typeof jQuery.jtrack.settings._addIgnoredRef&&jQuery.jtrack.settings._addIgnoredRef!==!1)&&_gaq.push(["_addIgnoredRef",jQuery.jtrack.settings.domain]),"undefined"!=typeof jQuery.jtrack.settings.cookiePath&&_gaq.push(["_setCookiePath",jQuery.jtrack.settings.cookiePath]),null===jQuery.jtrack.settings.status_code||200===jQuery.jtrack.settings.status_code?_gaq.push(["_trackPageview"]):(debug("Tracking error "+jQuery.jtrack.settings.status_code),_gaq.push(["_trackPageview","/"+jQuery.jtrack.settings.status_code+".html?page="+document.location.pathname+document.location.search+"&from="+document.referrer])),jQuery.isFunction(b)&&b(pageTracker)},jQuery.jtrack.load_script=function(a,b,c){jQuery.ajax({type:"GET",url:a,success:function(){if(!defined(_gat))throw debug("!!!!!! _gat has NOT been defined !!!!!!!"),"_gat has not been defined";debug("!!!!!! loaded the GA code !!!!!!!"),jQuery.jtrack.init_analytics(b,c)},dataType:"script",cache:!0})},jQuery.fn.trackPage=function(a,b,c){var d="https:"===document.location.protocol?"https://ssl":"http://www";jQuery.jtrack.settings=jQuery.extend({},{onload:!0,status_code:200},b);var e=d+".google-analytics.com/ga.js";"undefined"!=typeof _gat&&_gaq.length>0?debug("!!!!!! Google Analytics loaded previously !!!!!!!"):jQuery.jtrack.settings.onload===!0||null===jQuery.jtrack.settings.onload?jQuery(document).ready(function(){jQuery.jtrack.load_script(e,a,c)}):jQuery.jtrack.load_script(e,a,c)},jQuery.jtrack.trackEvent=function(a,b,c,d,e,f,g,h){if(defined(b)){var i=["_trackEvent"];null!==c&&i.push(c),null!==d&&i.push(d),null!==e&&i.push(e),null!==f&&i.push(f),null!==g&&i.push(g),b._trackEvent(c,d,e,f,g),"undefined"!=typeof h&&(jQuery.isFunction(h)?h(a):evaluate(a,h)),debug("Fired event for Tracking for _event"),debug(dump(i))}else debug("FATAL: pageTracker is not defined")},jQuery.jtrack.trackSocial=function(a,b,c,d){if(defined(pageTracker)){var e=["_trackSocial"];null!==a&&e.push(a),null!==b&&e.push(b),null!==c&&e.push(c),null!==d&&e.push(d),pageTracker._trackSocial(a,b,c,d)}else debug("FATAL: pageTracker is not defined")},jQuery.jtrack.trackPageview=function(a,b){defined(a)&&(a._trackPageview(b),debug("Fired event for _trackPageview for "+b))},jQuery.jtrack.make_campaign_str=function(a){function b(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null}function c(){var a={},c=b("__utmz");if(c){var d=c.split(".");if(d.length>=4){var e=d[4].split("|"),f=0;for(f=0;f<e.length;f++){var g=e[f].split("=");a[g[0]]=g[1]}}}return a}var d=c(),e=null,f="";return 0!==d.length&&"undefined"!==d.utmccn&&"(direct)"!==d.utmccn&&"(referral)"!==d.utmccn&&"undefined"!==d.utmcsr&&"(direct)"!==d.utmcsr&&"(referral)"!==d.utmcsr?("undefined"!==d.utmcsr&&(f+="utm_source="+d.utmcsr),"undefined"!==d.utmcmd&&(f+="&utm_medium="+d.utmcmd),"undefined"!==d.utmccn&&(f+="&utm_campaign="+d.utmccn),"undefined"!==d.utmctr&&(f+="&utm_term="+d.utmctr),"undefined"!==d.utmccn&&(f+="&utm_content="+d.utmccn)):(e="undefined"!==d.utmcsr?d.utmcsr:"",f+="utm_source="+window.location.host.split(".").join("-")+"&utm_medium=online&utm_campaign="+window.location.host.split(".").join("-")+"-"+e+"&utm_term=&utm_content="),"utm_source=undefined&utm_medium=undefined&utm_campaign=undefined&utm_term=undefined&utm_content=undefined"===f&&(e="undefined"!==d.utmcsr?d.utmcsr:"",f="utm_source="+window.location.host.split(".").join("-")+"&utm_medium=online&utm_campaign="+window.location.host.split(".").join("-")+"-"+e+"&utm_term=&utm_content="),jQuery.isFunction(a)?(a(f),!1):f},jQuery.jtrack.make_forced_camp=function(a,b){if(b.indexOf("_link")>-1&&"added"!==a.data("tracker")){var c=a.attr("href"),d=jQuery.jtrack.make_campaign_str();debug(d+" of campaign"),""!==d&&-1===window.location.toString().indexOf("inquiry?")&&-1===c.indexOf("utm_campaign")&&(a.attr("href",c+(c.indexOf("?")>-1?"&":"?")+d),debug(a.attr("href")+" of camp"),a.data("tracker","added"))}},jQuery.jtrack.clearCampaignUrl=function(){var a=window.location.href;if(a.indexOf("utm_source=")>-1){var b=a.split(window.location.host)[1];b=a.split("?")[0],window.history.pushState(null,jQuery(document).find("title").text(),b)}},jQuery.fn.jtrack=function(a){return jQuery.each(jQuery(this),function(){var b=jQuery(this),c=jQuery.extend({},jQuery.jtrack.defaults,a),d=evaluate(b,c.overwrites);if(d="undefined"===d?"true":d,b.is(".tracked")&&"false"===d)return!1;b.addClass("tracked");var e=c.mode,f=evaluate(b,c.alias),g=evaluate(b,c.category),h=evaluate(b,c.action),i=evaluate(b,c.eventTracked);h=""===h?i:h;var j=evaluate(b,c.label),k=evaluate(b,c.value);k=isNaN(k)?1:k;var l=evaluate(b,c.skip_internal),m=evaluate(b,c.skip_campaign),n=evaluate(b,c.noninteraction);n="undefined"===n?"false":n;var o=(c._link,c.callback);b.attr("role",i+"_"+h+"_"+g);var p=i+"."+("undefined"===f||null===f?"jtrack":f),q=l&&b[0].hostname===location.hostname,r="undefined"===f||null===f?i:f;jtrackedOptions[r]=[],jtrackedOptions[r].ele=b,jtrackedOptions[r].tasactedEvent=p,"true"===d&&(b.off(p),b.unbind(p),debug("overwriting "+p)),debug("setting event "+p),b.on(p,function(a){if(debug("doing event "+p),e.indexOf("_link")>-1&&(a.preventDefault(),a.stopPropagation(),m||jQuery.jtrack.make_forced_camp(b,e)),!q&&e.indexOf("event")>-1&&jQuery.jtrack.trackEvent(b,pageTracker,g,h,j,k,n,o),e.indexOf("_social")>-1){var d=evaluate(b,c.network),f=evaluate(b,c.socialAction);jQuery.jtrack.trackSocial(d,f)}return e.indexOf("_link")>-1?(debug("Fired _link for Tracking for _link"),debug(b.attr("href")),_gaq.push(["_link",b.attr("href")]),_gaq.push(function(){{var a=_gat._getTrackerByName();a._getLinkerUrl(window.location.toString())}""!==b.attr("target")&&"_self"!==b.attr("target")?window.open(b.attr("href"),b.attr("target")):window.location.href=b.attr("href")}),!1):!0})})}}(jQuery);